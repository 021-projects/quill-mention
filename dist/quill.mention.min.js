!function(e){var n={};function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/assets/",t(t.s=0)}([function(e,n,t){e.exports=t(1)},function(e,n,t){"use strict";function i(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}t(2);var s=function(){function e(n,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOpen=!1,this.menuItemIndex=0,this.atPos=null,this.pattern=/^[a-zA-Z0-9_]*$/,this.values=[],this.quill=n,this.jsonUrl=t.jsonUrl,this.defaultSuggestions=t.defaultSuggestions,this.maxLen=t.maxLen||31,this.mentionContainer=document.createElement("div"),this.mentionContainer.className="ql-mention-list-container",this.mentionContainer.style.cssText="display: none; position: absolute;",this.mentionContainer.innerHTML='<ul id="ql-mention-list" class="ql-mention-list"></ul>',document.body.appendChild(this.mentionContainer),this.mentionList=document.getElementById("ql-mention-list"),n.on("text-change",this.onTextChange.bind(this)),n.on("selection-change",this.onSelectionChange.bind(this)),n.keyboard.addBinding({key:9},this.selectHandler.bind(this)),n.keyboard.bindings[9].unshift(n.keyboard.bindings[9].pop()),n.keyboard.addBinding({key:13},this.selectHandler.bind(this)),n.keyboard.bindings[13].unshift(n.keyboard.bindings[13].pop()),n.keyboard.addBinding({key:27},this.escapeHandler.bind(this)),n.keyboard.addBinding({key:38},this.upHandler.bind(this)),n.keyboard.addBinding({key:40},this.downHandler.bind(this))}var n,t,s;return n=e,(t=[{key:"selectHandler",value:function(){return!this.isOpen||(this.selectMenuItem(),!1)}},{key:"escapeHandler",value:function(){return!this.isOpen||(this.hideMentionMenu(),!1)}},{key:"upHandler",value:function(){return!this.isOpen||(this.prevMenuItem(),!1)}},{key:"downHandler",value:function(){return!this.isOpen||(this.nextMenuItem(),!1)}},{key:"showMentionMenu",value:function(){this.mentionContainer.style.display="",this.isOpen=!0}},{key:"hideMentionMenu",value:function(){this.tryCancelToken(),this.mentionContainer.style.display="none",this.isOpen=!1}},{key:"highlightMenuItem",value:function(){for(var e=0;e<this.mentionList.childNodes.length;e+=1)this.mentionList.childNodes[e].classList.remove("selected");this.mentionList.childNodes[this.menuItemIndex].classList.add("selected")}},{key:"selectMenuItem",value:function(){var e=this.quill.getSelection(),n=this.atPos.atPos,t=e.index,i=this.mentionList.childNodes[this.menuItemIndex].dataset.username.username,s="@".concat(i);this.quill.deleteText(n,t-n,this.quill.sources.API),this.quill.insertEmbed(n,"mention",s,this.quill.sources.API),this.quill.insertText(n+1," ",this.quill.sources.API),this.quill.setSelection(n+2,this.quill.sources.API),this.hideMentionMenu()}},{key:"onMenuItemClick",value:function(e){e.stopImmediatePropagation(),e.preventDefault(),this.menuItemIndex=e.currentTarget.dataset.index,this.highlightMenuItem(),this.selectMenuItem()}},{key:"renderItem",value:function(e){this.mentionList.appendChild(e)}},{key:"renderMenuList",value:function(e){if(e&&e.length>0){this.values=e,this.mentionList.innerHTML="";for(var n=0;n<e.length;n+=1){var t=document.createElement("li");t.className="ql-mention-list-item",t.dataset.index=n,t.dataset.username=e[n].username,t.innerHTML='<img src="'.concat(e[n].avatar,'">').concat(e[n].username," <small>(").concat(e[n].status,")</small>"),t.onclick=this.onMenuItemClick.bind(this),this.mentionList.appendChild(t)}this.menuItemIndex=0,this.highlightMenuItem(),this.showMentionMenu()}else this.hideMentionMenu()}},{key:"getUsersAndRenderMentionMenu",value:function(e){var n=this,t=this.jsonUrl;axios.get(t,{cancelToken:new this.CancelToken(function(e){n.cancel=e}),params:{username:e}}).then(function(e){var t=[];Object.keys(e.data).forEach(function(n){var i=e.data[n];t.push({username:i.username,status:i.status,avatar:i.avatar})}),n.renderMenuList(t)}).catch()}},{key:"nextMenuItem",value:function(){this.menuItemIndex=(this.menuItemIndex+1)%this.values.length,this.highlightMenuItem()}},{key:"prevMenuItem",value:function(){this.menuItemIndex=(this.menuItemIndex+this.values.length-1)%this.values.length,this.highlightMenuItem()}},{key:"hasValidChars",value:function(e){return this.pattern.test(e)}},{key:"setMentionMenuPosition",value:function(e){var n=this.quill.container.getBoundingClientRect(),t=this.quill.getBounds(e);this.mentionContainer.style.top="".concat(window.scrollY+n.top+t.bottom,"px"),this.mentionContainer.style.left="".concat(window.scrollX+n.left+t.left,"px")}},{key:"onSomethingChange",value:function(){var e=this.quill.getSelection().index,n=Math.max(0,e-this.maxLen),t=this.quill.getText(n,e-n),i=t.lastIndexOf("@");if(i>-1){var s=e-(t.length-i);this.atPos=s,this.setMentionMenuPosition(s);var o=s+1,a=this.quill.getText(o,e-o);this.hasValidChars(a)?0===a.length?(this.renderMenuList(this.defaultSuggestions),this.tryCancelToken()):this.getUsersAndRenderMentionMenu(a):this.hideMentionMenu()}else this.hideMentionMenu()}},{key:"onTextChange",value:function(e,n,t){"user"===t&&this.onSomethingChange()}},{key:"onSelectionChange",value:function(e){e&&0===e.length?this.onSomethingChange():this.hideMentionMenu()}}])&&i(n.prototype,t),s&&i(n,s),e}();Quill.register("modules/mention",s)},function(e,n){}]);