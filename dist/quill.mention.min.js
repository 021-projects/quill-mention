!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),s=(n.n(i),n(3)),o=(n.n(s),n(5));Quill.register("modules/mention",class{constructor(e,t){this.isOpen=!1,this.menuItemIndex=0,this.atPos=null,this.cursorPos=null,this.pattern=/^[a-zA-Z0-9_]*$/,this.values=[],this.quill=e,this.source=t.source,this.maxLen=t.maxLen||31,this.mentionContainer=document.createElement("div"),this.mentionContainer.className="ql-mention-list-container",this.mentionContainer.style.cssText="display: none; position: absolute;",this.mentionContainer.innerHTML='<ul id="ql-mention-list" class="ql-mention-list"></ul>',document.body.appendChild(this.mentionContainer),this.mentionList=document.getElementById("ql-mention-list"),e.on("text-change",this.onTextChange.bind(this)),e.on("selection-change",this.onSelectionChange.bind(this)),e.keyboard.addBinding({key:o.a.TAB},this.selectHandler.bind(this)),e.keyboard.bindings[9].unshift(e.keyboard.bindings[9].pop()),e.keyboard.addBinding({key:o.a.ENTER},this.selectHandler.bind(this)),e.keyboard.bindings[13].unshift(e.keyboard.bindings[13].pop()),e.keyboard.addBinding({key:o.a.ESCAPE},this.escapeHandler.bind(this)),e.keyboard.addBinding({key:o.a.UP},this.upHandler.bind(this)),e.keyboard.addBinding({key:o.a.DOWN},this.downHandler.bind(this))}selectHandler(){return!this.isOpen||(this.selectMenuItem(),!1)}escapeHandler(){return!this.isOpen||(this.hideMentionMenu(),!1)}upHandler(){return!this.isOpen||(this.prevMenuItem(),!1)}downHandler(){return!this.isOpen||(this.nextMenuItem(),!1)}showMentionMenu(){this.mentionContainer.style.display="",this.isOpen=!0}hideMentionMenu(){this.mentionContainer.style.display="none",this.isOpen=!1}highlightMenuItem(){for(let e=0;e<this.mentionList.childNodes.length;e+=1)this.mentionList.childNodes[e].classList.remove("selected");this.mentionList.childNodes[this.menuItemIndex].classList.add("selected")}selectMenuItem(){const e=this.mentionList.childNodes[this.menuItemIndex].dataset.username;this.quill.deleteText(this.atPos,this.cursorPos-this.atPos,Quill.sources.API),this.quill.insertEmbed(this.atPos,"mention",e,Quill.sources.API),this.quill.insertText(this.atPos+1," ",Quill.sources.API),this.quill.setSelection(this.atPos+2,Quill.sources.API),this.hideMentionMenu()}onMenuItemClick(e){e.stopImmediatePropagation(),e.preventDefault(),this.menuItemIndex=e.currentTarget.dataset.index,this.highlightMenuItem(),this.selectMenuItem()}renderItem(e){this.mentionList.appendChild(e)}renderMenuList(e){if(e&&e.length>0){this.values=e,this.mentionList.innerHTML="";for(let t=0;t<e.length;t+=1){const n=document.createElement("li");n.className="ql-mention-list-item",n.dataset.index=t,n.dataset.username=e[t].username,n.innerHTML=`<img src="${e[t].avatar}">${e[t].username} <small>(${e[t].status})</small>`,n.onclick=this.onMenuItemClick.bind(this),this.mentionList.appendChild(n)}this.menuItemIndex=0,this.highlightMenuItem(),this.showMentionMenu()}else this.hideMentionMenu()}nextMenuItem(){this.menuItemIndex=(this.menuItemIndex+1)%this.values.length,this.highlightMenuItem()}prevMenuItem(){this.menuItemIndex=(this.menuItemIndex+this.values.length-1)%this.values.length,this.highlightMenuItem()}hasValidChars(e){return this.pattern.test(e)}setMentionMenuPosition(e){const t=this.quill.container.getBoundingClientRect(),n=this.quill.getBounds(e);this.mentionContainer.style.top=`${window.scrollY+t.top+n.bottom}px`,this.mentionContainer.style.left=`${window.scrollX+t.left+n.left}px`}onSomethingChange(){const e=this.quill.getSelection();this.cursorPos=e.index;const t=Math.max(0,this.cursorPos-this.maxLen),n=this.quill.getText(t,this.cursorPos-t),i=n.lastIndexOf("@");if(i>-1){const e=this.cursorPos-(n.length-i);this.atPos=e,this.setMentionMenuPosition(e);const t=e+1,s=this.quill.getText(t,this.cursorPos-t);this.hasValidChars(s)?this.source(s):this.hideMentionMenu()}else this.hideMentionMenu()}onTextChange(e,t,n){"user"===n&&this.onSomethingChange()}onSelectionChange(e){e&&0===e.length?this.onSomethingChange():this.hideMentionMenu()}})},function(e,t){},function(e,t){const n=Quill.import("blots/embed");class i extends n{static create(e){const t=super.create();return t.innerHTML=e,t.dataset.username=e.replace("@",""),t}}i.blotName="mention",i.tagName="MENTION",Quill.register(i)},,function(e,t,n){"use strict";t.a={TAB:9,ENTER:13,ESCAPE:27,UP:38,DOWN:40}}]);